Flags
=====
f1    host busy
f2    Vice sent mail
f3    host sent mail



Host
====
if f2:                      // I got mail?
	f1 = true;          // I'm going to be busy
	process mail;
	send mail;
	f3 = true;          // I sent mail
	f1 = false;         // I'm not busy



Vice
====
// ***** make mail & send
if not f2:                     // I didn't send any mail yet
	if not f1:             // host isn't busy
		make mail;
		send mail;
		f2 = true;     // I sent mail

// ***** process mail
if f3:                         // I got mail?
	process mail;
	f3 = false;
	
	
	
